TinyCore.Module.define("models_vidtop",[],function(){var e={};return{onStart:function(e){},getDataItem:function(e,t){var o=e+"."+t.id;return t.post={ID:o},t.href="#p/"+o,t.link="#p/"+o,t.content=t.text,t.post_id=o,t},getDataList:function(e,t){var o=this;o.getData(e,function(n){t(n.filter(function(e){return e}).map(function(t){return o.getDataItem(e,t)}))})},getPlayObj:function(e,t){console.log("getPlayObj:"+e);var o=this;if(e){var n=e.split("."),i=n[0],r=n[1];o.getData(i,function(e){console.log("_e2_:"),console.log(e);var n=e.filter(function(e){return e.id==r})[0];console.log("e2"),console.log(n),o.getDataPlayDetail(n,t)})}else t()},getDataPlayDetail:function(e,t){console.log("_e2222222"),console.log(e),this.getData(e.player,function(o){var n=o.constructor===Array?o[0]:o;if("youtube"==e.src_type){var i=e.src_play;Object.assign(n.meta,{title:e.title,subTitle:e.subTitle}),Object.assign(n,{codes:["https://www.youtube.com/watch?v="+i],poster:"https://img.youtube.com/vi/"+i+"/maxresdefault.jpg",preview:{previewSeconds:"0",previewLink:"",previewTitle:"",previewDescription:""}}),n.options.youtube=1,n.options.code=e.src_play}console.log("_e3"),console.log(n),t(n)})},_getDataHandler:function(t,o,n,i){var r=t.filter(function(e){return e.status});e[o]=n?r.filter(function(e){return e.id==n}):r,i(e[o])},getData:function(e,t){var o,n,i=this;if(/\./.test(e)){var r=e.split(".");o=r[1],n=r[0]}else n=e;var a="https://docs.google.com/spreadsheets/d/e/"+n+"/pub?output=csv";i._api(a,function(n){i._getDataHandler(n,e,o,t)})},_csvJSON:function(e){for(var t=[],o=e[0],n=1;n<e.length;n++){for(var i,r={},a=e[n],s=0;s<o.length;s++)i=a[s],objectPath.set(r,o[s],i);t.push(r)}return t},_api:function(e,t){function o(e){e&&console.log(e),console.log("       Time:",a-l||"(Unknown; your browser does not support the Performance API)","ms")}function n(e){a=r(),o("Parse complete");var n=s._csvJSON(e.data);t(n)}function i(e,t){a=r(),console.log("ERROR:",e,t)}function r(){return void 0!==window.performance?window.performance.now():0}var a,s=this,c={delimiter:"",newline:"",quoteChar:'"',header:!1,dynamicTyping:!0,preview:0,encoding:"",worker:!1,comments:!1,skipEmptyLines:!1,chunk:void 0,fastMode:void 0,beforeFirstChunk:void 0,withCredentials:void 0,step:void 0,complete:n,error:i,download:!0},l=r();Papa.parse(e,c)}}});