/* 2017 Jason Mulligan <jason.mulligan@avoidwork.com> */

"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new LRU(a)}var c="undefined"!=typeof process?process.nextTick:function(a){return setTimeout(a,1)},d="undefined"!=typeof Reflect?Reflect.ownKeys:Object.keys,LRU=function(){function LRU(a){return _classCallCheck(this,LRU),this.max=a,this.notify=!1,this.reset()}return _createClass(LRU,[{key:"clear",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.reset(),!a&&this.notify&&c(this.onchange("clear",this.dump())),this}},{key:"delete",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.remove(a,b)}},{key:"dump",value:function(){return JSON.stringify(this,null,0)}},{key:"evict",value:function(){return this.has(this.last)&&this.remove(this.last,!0),this.notify&&c(this.onchange("evict",this.dump())),this}},{key:"get",value:function(a){var b=void 0;return this.has(a)&&(b=this.cache[a].value,this.set(a,b),this.notify&&c(this.onchange("get",this.dump()))),b}},{key:"has",value:function(a){return a in this.cache}},{key:"onchange",value:function(){}},{key:"remove",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d="string"!=typeof a?a.toString():a,e=this.cache[d];return e?(delete this.cache[d],this.length--,this.has(e.previous)?(this.cache[e.previous].next=e.next,this.first===d&&(this.first=e.previous)):this.first===d&&(this.first=null),this.has(e.next)?(this.cache[e.next].previous=e.previous,this.last===d&&(this.last=e.next)):this.last===d&&(this.last=null)):(this.first===d&&(this.first=null),this.last===d&&(this.last=null)),!b&&this.notify&&c(this.onchange("remove",this.dump())),e}},{key:"reset",value:function(){return this.cache=Object.create(null),this.first=null,this.last=null,this.length=0,this}},{key:"set",value:function(a,b){var d=void 0,e=void 0;return this.has(a)?(e=this.cache[a],e.value=b,e.next=null,e.previous=this.first!==a?this.first:null,this.last===a&&null!==e.previous&&(this.last=e.previous)):(++this.length>this.max&&this.remove(this.last,!0),1===this.length&&(this.last=a),this.cache[a]={next:null,previous:this.first,value:b}),this.first!==a&&this.has(this.first)&&(d=this.cache[this.first],d.next=a,d.previous===a&&(d.previous=null)),this.first=a,this.notify&&c(this.onchange("set",this.dump())),this}},{key:"update",value:function(a){var b=this,c=JSON.parse(a);d(c).forEach(function(a){b[a]=c[a]})}}]),LRU}();"undefined"!=typeof exports?module.exports=b:"function"==typeof define&&void 0!==define.amd?define(function(){return b}):a.lru=b}("undefined"!=typeof window?window:global);
//# sourceMappingURL=tiny-lru.min.js.map