TinyCore.Module.define("models_vidtop",[],function(){var t=window.vidtop._cache;return{onStart:function(t){},getDataItem:function(t,e){var i=t+"."+e.id;return e.post={ID:i},e.href="#p/"+i,e.link="#p/"+i,e.content=e.text,e.post_id=i,e},getDataList:function(t,e){var i=this;i.getData(t,function(n){e(n.filter(function(t){return t}).map(function(e){return i.getDataItem(t,e)}))})},getPlayObj:function(t,e){var i=this;i.getData(t,function(t){i.getDataPlayDetail(t,e)})},getDataPlayDetail:function(t,e){t.player||(t.player=vidtop.config.player),this.getData(t.player,function(i){!function(t,e,i){var n=e.constructor===Array?e[0]:e;Object.assign(n.meta,{title:t.title,subTitle:t.subTitle}),n.preview={previewSeconds:"0",previewLink:"",previewTitle:"",previewDescription:""},n.options.type=t.src_type,n.options.code=t.src_play,i(n)}(t,i,e)})},_getDataHandler:function(t,e,i,n){var a=t.filter(function(t){return t.status});n(i?a.filter(function(t){return t.id==i})[0]:a)},getData:function(e,i){var n,a,o=this;if(/\./.test(e)){var r=e.split(".");n=r[1],a=r[0]}else a=e;var c="https://docs.google.com/spreadsheets/d/e/"+(a=a.replace(/---/g,"_").replace(".html",""))+"/pub?output=csv",p=t.get(a);p?vidtop.config&&vidtop.config.player&&a==vidtop.config.player?o._getDataHandler(JSON.parse(p),e,n,i):o._getDataHandler(p,e,n,i):o._api(c,function(r){vidtop.config&&vidtop.config.player&&a==vidtop.config.player?t.set(a,JSON.stringify(r)):t.set(a,r),o._getDataHandler(r,e,n,i)})},_csvJSON:function(t){for(var e=[],i=t[0],n=1;n<t.length;n++){for(var a,o={},r=t[n],c=0;c<i.length;c++)a=r[c],objectPath.set(o,i[c],a);e.push(o)}return e},_api:function(t,e){function i(t){o=a();var i=r._csvJSON(t.data);e(i)}function n(t,e){o=a()}function a(){return void 0!==window.performance?window.performance.now():0}var o,r=this,c={delimiter:"",newline:"",quoteChar:'"',header:!1,dynamicTyping:!0,preview:0,encoding:"",worker:!1,comments:!1,skipEmptyLines:!1,chunk:void 0,fastMode:void 0,beforeFirstChunk:void 0,withCredentials:void 0,step:void 0,complete:i,error:n,download:!0};a();Papa.parse(t,c)}}});